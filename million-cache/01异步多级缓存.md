

### 大型电商网站的详情页架构
大网站的模板，可能所有页面要重新渲染。

>- 商品服务、店铺服务、品牌服务->MQ
（一有变更就发送到MQ上，eg.价格修改）
>- 缓存数据生产服务（多级缓存架构——ehcache本地缓存->redis缓存） 监听MQ  
（若页面数据有变更，及时监听到，且写入缓存，提供高并发、高性能访问）
>- nginx（内含HTML模板，本地缓存的数据(eg.有效期10分钟)）若HTML模板变了，不用全量重新渲染，直接将最新的HTML模板推送到nginx服务器即可。

- 用户访问前端，前端通过nginx取本地缓存，若有，则直接渲染到HTML模板;  
- 若无，到redis查询，并返回到本地缓存，渲染HTML;
- 若redis无数据（内存有限，被缓存清理算法清掉），则发请求到缓存数据生产服务（先到ehcache取，没有再发送请求到商品服务（需事务，一般为mysql））  

大多数情况下，数据直接从nginx本地取缓存，没有网络请求开销，没业务逻辑，直接渲染到模板中，HTML页面返回。

支撑高并发、高可用、海量数据、备份、随时可恢复，缓存架构要支撑这些要点，首先redis就得支撑。

redis架构，每秒钟几十万的访问量QPS，99.99%的高可用性，TB级的海量数据，备份和恢复，支撑缓存架构，最基础的就是redis架构。